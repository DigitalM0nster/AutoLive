# Система записей (Booking System)

## Описание

Система записей позволяет создавать и управлять временными записями клиентов на различные услуги (ТО, диагностика, консультации и т.д.).

## Основные возможности

### 1. Создание записей
- **Дата и время** - планирование конкретного времени
- **Менеджер** - назначение ответственного сотрудника
- **Клиент** - зарегистрированный или незарегистрированный
- **Примечания** - дополнительная информация о записи

### 2. Статусы записей
- **Запланирована** - новая запись
- **Подтверждена** - клиент подтвердил запись
- **Выполнена** - услуга оказана
- **Отменена** - запись отменена
- **Не явился** - клиент не пришел

### 3. Типы клиентов
- **Зарегистрированные** - связаны с аккаунтом пользователя
- **Незарегистрированные** - контактные данные сохраняются в примечаниях

## Структура базы данных

### Модель Booking
```sql
model Booking {
  id            Int           @id @default(autoincrement())
  scheduledDate DateTime      // Дата записи
  scheduledTime String        // Время в формате "14:30"
  clientId      Int?          // ID зарегистрированного клиента (опционально)
  managerId     Int           // ID ответственного менеджера
  status        BookingStatus // Статус записи
  notes         String?       // Примечания
  createdAt     DateTime      // Дата создания
  updatedAt     DateTime      // Дата обновления

  // Связи
  client  User? @relation("ClientBookings")
  manager User  @relation("ManagerBookings")
}
```

### Enum BookingStatus
```sql
enum BookingStatus {
  scheduled // Запланирована
  confirmed // Подтверждена
  completed // Выполнена
  cancelled // Отменена
  no_show   // Не явился
}
```

## API Endpoints

### GET /api/bookings
Получить список записей с фильтрацией и пагинацией.

**Параметры:**
- `page` - номер страницы (по умолчанию 1)
- `limit` - количество записей на странице (по умолчанию 10)
- `status` - фильтр по статусу
- `managerId` - фильтр по менеджеру
- `clientId` - фильтр по клиенту
- `dateFrom` - фильтр по дате от
- `dateTo` - фильтр по дате до

### POST /api/bookings
Создать новую запись.

**Тело запроса:**
```json
{
  "scheduledDate": "2024-12-25",
  "scheduledTime": "14:30",
  "managerId": 1,
  "clientId": 2, // опционально
  "notes": "ТО автомобиля"
}
```

### GET /api/bookings/[id]
Получить конкретную запись по ID.

### PUT /api/bookings/[id]
Обновить запись.

### DELETE /api/bookings/[id]
Удалить запись.

## Интерфейс админки

### Страница /admin/bookings
- **Список записей** - отображение всех записей с информацией
- **Создание записи** - форма для создания новой записи
- **Управление статусами** - изменение статуса записи
- **Удаление записей** - удаление ненужных записей

### Карточка записи содержит:
- ID записи и дата/время
- Статус с цветовой индикацией
- Информация о менеджере
- Информация о клиенте
- Примечания
- Управление статусом
- Кнопка удаления

## Навигация

Записи добавлены в главное меню админки между "Заказы" и "Категории".

## Типы TypeScript

Все типы определены в `src/lib/types.ts`:

```typescript
export type BookingStatus = "scheduled" | "confirmed" | "completed" | "cancelled" | "no_show";

export type Booking = {
  id: number;
  scheduledDate: string | Date;
  scheduledTime: string;
  clientId?: number | null;
  managerId: number;
  status: BookingStatus;
  notes?: string | null;
  createdAt: string | Date;
  updatedAt: string | Date;
  client?: User | null;
  manager: User;
};
```

## Использование

1. **Перейти в админку** → **Записи**
2. **Создать запись** - нажать "Создать запись"
3. **Заполнить форму** - указать дату, время, менеджера, примечания
4. **Сохранить** - запись появится в списке
5. **Управлять статусами** - изменять статус через выпадающий список
6. **Удалять записи** - при необходимости

## Отличия от заказов

- **Записи** - планирование будущего времени
- **Заказы** - выполнение конкретных работ с товарами/услугами
- **Разные статусы** и логика работы
- **Отдельные API** и интерфейсы
- **Независимое развитие** функциональности
